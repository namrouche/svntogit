<html xmlns:xs="http://www.w3.org/2001/XMLSchema" lang="FR">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   
      <title>Esup Lecture Portlet - Installation Guide</title>
      <link rel="stylesheet" href="http://www.esup-portail.org/consortium/espace/docbook/esup.css" type="text/css">
      <meta name="generator" content="DocBook ESUP XSL Stylesheets V1.0">
   </head>
   <body>
      <div class="pagetitleborder"><span class="pagetitle">Esup Lecture Portlet - Installation Guide</span><br></div>
      <div class="articleinfo">
         <table>
            <tr>
               <td><img src="../images/logoCLectureV1.jpg" align="left"></td>
               <td valign="center" width="100%">
                  <div class="abstract">
                           
                     <p>XML aggregation portlet. Use French word &#8220;Lecture&#8221; in his
                              name.
                     </p>
                         
                  </div><br></td>
            </tr>
         </table><span class="firstname">Bourges</span>&nbsp;
         		<span class="surname">Raymond - Bouteille Gw&eacute;na&euml;lle</span>&nbsp;
         		<br><div class="affiliation"><span class="orgname"><a href="http://www.univ-rennes1.fr">University of Rennes
                          1</a></span></div><br></div>
      <div class="index">
         <dl>
            <dt><span class="sectionmenu"><a href="#1">1.  Important note</a></span></dt>
            <dt><span class="sectionmenu"><a href="#2">2.  Installation</a></span></dt>
            <dt><span class="sectionmenu"><a href="#3">3.  Configuration</a></span></dt>
            <dd>
               <dl>
                  <dt><span class="sectionmenu"><a href="#3.1">3.1.  Technical configuration</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="sectionmenu"><a href="#3.1.1">3.1.1.  esup-lecture.xml</a></span></dt>
                     </dl>
                  </dd>
                  <dt><span class="sectionmenu"><a href="#3.2">3.2.  Content configuration</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="sectionmenu"><a href="#3.2.1">3.2.1.  esup-lecture.xml and &lt;category&gt;.xml</a></span></dt>
                        <dt><span class="sectionmenu"><a href="#3.2.2">3.2.2.  mappings.xml</a></span></dt>
                        <dt><span class="sectionmenu"><a href="#3.2.3">3.2.3.  portlet.xml</a></span></dt>
                        <dt><span class="sectionmenu"><a href="#3.2.4">3.2.4.  auth.xlm</a></span></dt>
                     </dl>
                  </dd>
               </dl>
            </dd>
            <dt><span class="sectionmenu"><a href="#4">4.  Servlet mode</a></span></dt>
            <dd>
               <dl>
                  <dt><span class="sectionmenu"><a href="#4.1">4.1.  Introduction</a></span></dt>
                  <dt><span class="sectionmenu"><a href="#4.2">4.2.  Authentication</a></span></dt>
                  <dt><span class="sectionmenu"><a href="#4.3">4.3.  Authorization</a></span></dt>
                  <dt><span class="sectionmenu"><a href="#4.4">4.4.  Guest mode</a></span></dt>
               </dl>
            </dd>
         </dl>
      </div><a name="1"></a>
          
      <h1>1.  Important note</h1>
      
          
      <p>Because of uPortal limitation before 2.6.1 release in session
             objects management esup-lecture may produce null pointer exceptions
             randomly. For this esup-lecture, since 0.9.0 release has a full support of
             servlet mode. Please see &#8220;Servlet mode&#8221; section for more
             information.
      </p>
        <a name="2"></a>
          
      <h1>2.  Installation</h1>
      
          
      <div>
         <ul>
            <li>
                       
               <p>Download esup-lecture-&lt;version&gt;.zip from <a href="https://sourcesup.cru.fr/frs/?group_id=251">the project
                             site</a></p>
                     
            </li>
            <li>
                       
               <p>Unzip the file somewhere on a working directory</p>
               
                       
               <p>
                  <div class="note">
                     <p class="notetitle">
                        						Note
                        					
                     </p>
                     <p>To configure this application you have to adapt some
                                    configuration files. Every time you will find a
                                    &lt;fileName&gt;-example.&lt;extension&gt; example file that you
                                    can copy to &lt;fileName&gt;.&lt;extension&gt; before
                                    adapting.
                     </p>
                  </div>
               </p>
                     
            </li>
            <li>
                       
               <p>Adapt build.properties</p>
                     
            </li>
            <li>
                       
               <p>Adapt properties/config.properties for exception handling
                          configuration, SMTP configuration and database confuguration.
               </p>
               
                       
               <p>
                  <div class="note">
                     <p class="notetitle">
                        						Note
                        					
                     </p>
                     <p>By default, exception reports are also sent to an archived
                                    bugs mailing list, accessible to the developers of the project
                                    only. This feature is used to be warned of all the possible
                                    exceptions occuring on the applciation anywhere; this way, most
                                    bugs can be corrected as soon as they happen. If you do not want
                                    the exceptions to be sent to this list, you can manually set
                                    property doNotSendExceptionReportsToDevelopers to true.
                     </p>
                  </div>
               </p>
                     
            </li>
            <li>
                       
               <p>Test your configuration:
                  <div>
                     <ul>
                        <li>
                                         
                           <p>ant test-config</p>
                                       
                        </li>
                        <li>
                                         
                           <p>ant test-smtp</p>
                                       
                        </li>
                        <li>
                                         
                           <p>ant test-database</p>
                                       
                        </li>
                     </ul>
                  </div>
               </p>
                     
            </li>
            <li>
                       
               <p>Initialize your database if necessary (first
                          installation):
                  <div>
                     <ul>
                        <li>
                                         
                           <p>ant init-data
                              <div class="note">
                                 <p class="notetitle">
                                    						Note
                                    					
                                 </p>
                                 <p><span class="emphasisbold">This Command will erase all
                                                         existing data in your database !!!!</span></p>
                                 <p>Your database (configured in config.properties) must
                                                      exists.
                                 </p>
                              </div>
                           </p>
                                       
                        </li>
                     </ul>
                  </div>
               </p>
                     
            </li>
            <li>
                       
               <p>Deploy the application:
                  <div>
                     <ul>
                        <li>
                                         
                           <p>ant deploy</p>
                                       
                        </li>
                     </ul>
                  </div>
               </p>
                     
            </li>
            <li>
                       
               <p>Configure a new context in your application server. For example
                          with Tomcat create a LecturePortlet.xml file in the Toncat
                          conf/Catalina/localhost subfolder with content like this:
               </p>
               
                       
               <p><pre class="screen">&lt;Context path="/esup-lecture"
        docBase="D:/esupdev/esupdev-2.5-esup-2/uPortal-quick-start/webapps/esup-lecture"&gt;
        &lt;/Context&gt;</pre></p>
                     
            </li>
            <li>
                       
               <p>Configure your portal to reference this portlet. For example
                          with uPortal you can use channel manager as shown here:
               </p>
               
                       
               <div class="mediaobject">
                            
                              <img src="../images/channelManager.gif">
                            
                          
               </div>
               
                       
               <p>
                  <div class="note">
                     <p class="notetitle">
                        						Note
                        					
                     </p>
                     <p>Portlet definition ID is very important. Here it is
                                    <span class="emphasis">esup-lecture.esup-lecture.</span> Fisrt esup-lecture
                                    must be equal to the appliation server context name and second
                                    esup-lecture must be equal to the portlet-name of the
                                    WEB-INF/portlet.xml file.
                     </p>
                     <p>If you don't use this default value you have to adap the
                                    "portlet-guid" parameter of "The esup-lecture portlet servlet"
                                    servlet in the WEB-INF/web.xml too.
                     </p>
                  </div>
                  <div class="note">
                     <p class="notetitle">
                        						Note
                        					
                     </p>
                     <p>You can specify a preference with name "context" here too.
                                    See chapter 2.2.1 about context id for more information about
                                    this.
                     </p>
                  </div>
               </p>
               
                       
               <p>If you don&#8217;t use channel manager you can use a xml Portlet
                          definition file. You can use this file with an uPortal ant target like
                          <span class="command">ant uportal.pubchan -Dchannel=lecture-portlet.xml</span>.
                          For this, you have to save a <span class="command">lecture-portlet.xml</span>
                          file in the folder <span class="command">properties/chanpub</span> of your
                          uPortal distribution. This is an example of lecture-portlet.xml file
                          :
               </p>
               
                       
               <p><pre class="programlisting">&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;!DOCTYPE channel-definition SYSTEM "channelDefinition.dtd"&gt;

&lt;channel-definition&gt;

    &lt;title&gt;lecture-portlet&lt;/title&gt;
    &lt;name&gt;lecture-portlet&lt;/name&gt;
    &lt;fname&gt;lecture&lt;/fname&gt;
    &lt;desc&gt;Esup-Portail lecture portlet&lt;/desc&gt;
    &lt;type&gt;Portlet&lt;/type&gt;
    &lt;class&gt;org.jasig.portal.channels.portlet.CPortletAdapter&lt;/class&gt;
    &lt;timeout&gt;15000&lt;/timeout&gt;
    
    &lt;hasedit&gt;N&lt;/hasedit&gt;
    &lt;hashelp&gt;N&lt;/hashelp&gt;
    &lt;hasabout&gt;N&lt;/hasabout&gt;

    &lt;secure&gt;N&lt;/secure&gt;
    &lt;locale&gt;en_US&lt;/locale&gt;
    
    &lt;categories&gt;
        &lt;category&gt;Applications&lt;/category&gt;
    &lt;/categories&gt;
    
    &lt;groups&gt;
        &lt;group&gt;Everyone&lt;/group&gt;
    &lt;/groups&gt;
    
    &lt;parameters&gt;

        &lt;!-- The syntax of the portletDefinitionId is [portlet-context-name].[portlet-name] --&gt;
        &lt;parameter&gt;
            &lt;name&gt;portletDefinitionId&lt;/name&gt;
            &lt;value&gt;esup-lecture.esup-lecture&lt;/value&gt;
            &lt;description&gt;The syntax of the portletDefinitionId is [portlet-context-name].[portlet-name]&lt;/description&gt;
            &lt;ovrd&gt;N&lt;/ovrd&gt;
        &lt;/parameter&gt;

        &lt;parameter&gt;
            &lt;name&gt;PORTLET.context&lt;/name&gt;
            &lt;value&gt;default&lt;/value&gt;
            &lt;description&gt;The "context" Portlet preference in relationship with context@id of the esup-lecture.xml file&lt;/description&gt;
            &lt;ovrd&gt;N&lt;/ovrd&gt;
        &lt;/parameter&gt;

    &lt;/parameters&gt;
    
&lt;/channel-definition&gt;
</pre></p>
                     
            </li>
         </ul>
      </div>
        <a name="3"></a>
          
      <h1>3.  Configuration</h1>
      
          
      <p>You can configure your application. For this: adapt file(s) in
             properties directory and use <span class="command">ant deploy</span> to deploy again
             your application.
      </p>
      
          <a name="3.1"></a>
            
      <h2>3.1.  Technical configuration</h2>
      
            
      <p>Adapt to your environment these configuration files:</p>
      
            
      <div>
         <ul>
            <li>
                         
               <p><span class="command">logging/log4j.properties</span> for logging
                            configuration
               </p>
                       
            </li>
            <li>
                         
               <p><span class="command">esup-lecture.xml</span> for global
                            configuration
               </p>
                       
            </li>
         </ul>
      </div>
      
            <a name="3.1.1"></a>
              
      <h3>3.1.1.  esup-lecture.xml</h3>
      
              
      <p>This file contents some global configuration properties:</p>
      
              
      <div>
         <ul>
            <li>
                           
               <p>element <span class="command">guestUser</span> in
                              <span class="command">esup-lecture.xml</span>:
               </p>
               
                           
               <p><pre class="programlisting">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE channelConfig SYSTEM "lecture-config.dtd" &gt;
&lt;channelConfig&gt;
  &lt;guestUser&gt;guest&lt;/guestUser&gt;</pre><span class="command">guestUser</span>
                              is an optional propertie. Default value is "guest".
               </p>
               
                           
               <p>If current connected user name equals
                              <span class="command">guestUser</span> property then all controls used for
                              personalisation (change tree size buttons, mark an item as read
                              button, edit button, etc.) are hidden.
               </p>
               
                           
               <p>This is used in Portlet mode when esup-lecture is used in a
                              portal unauthenticated view.
               </p>
                         
            </li>
         </ul>
      </div>
            
          
      
          <a name="3.2"></a>
            
      <h2>3.2.  Content configuration</h2>
      
            
      <p>To adapt to your environment, edit these configuration
               files:
      </p>
      
            
      <div>
         <ul>
            <li>
                         
               <p><span class="command">esup-lecture.xml</span>: main configuration file.
                            Contexts and CategoryProfiles definition.
               </p>
               
                         
               <p>It also deals with <span class="command">&lt;category&gt;.xml</span> :
                            remote xml file referecend by CategoryProfiles.
               </p>
                       
            </li>
            <li>
                         
               <p><span class="command">mappings.xml</span>: declarations about xslt
                            transformation for interface display
               </p>
                       
            </li>
            <li>
                         
               <p><span class="command">portlet.xml</span>: it needs declaration of portal
                            user attributes used by Lecture Portlet
               </p>
                       
            </li>
            <li>
                         
               <p><span class="command">auth.xml</span>: auth configuration
               </p>
                       
            </li>
         </ul>
      </div>
      
            
      <div class="note">
         <p class="notetitle">
            						Note
            					
         </p>
         <p>XML Elements or attributes not explained here (but in dtd)
                    implements features that are not yet supported.
         </p>
      </div>
      
            <a name="3.2.1"></a>
              
      <h3>3.2.1.  esup-lecture.xml and &lt;category&gt;.xml</h3>
      
              
      <p>These files describe contexts, category profiles and userId
                 definition. Here is the structure of this file (for more information,
                 look at dtd <span class="command">lecture-config.dtd</span>):
      </p>
      
              
      <div>
         <ul>
            <li>
                           
               <p>element <span class="command">channelConfig</span> in
                              <span class="command">esup-lecture.xml</span>:<pre class="programlisting">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE channelConfig SYSTEM "lecture-config.dtd" &gt;
&lt;channelConfig&gt;
  
  &lt;!-- contexts definition --&gt;
  &lt;context&gt; ... &lt;/context&gt;
  &lt;context&gt; ... &lt;/context&gt;
  ...

  &lt;!-- category profile definition --&gt;
  &lt;categoryProfile&gt; ... &lt;/categoryProfile&gt;
  &lt;categoryProfile&gt; ... &lt;/categoryProfile&gt;
  ...

&lt;/channelConfig&gt; </pre></p>
                         
            </li>
            <li>
                           
               <p>element <span class="command">context</span> :
               </p>
               
                           
               <p><pre class="programlisting">&lt;context 
   name = "D&eacute;monstration Esup-Lecture"
   id = "default"&gt;
   &lt;description&gt;Context de d&eacute;mo&lt;/description&gt; 
   &lt;refCategoryProfile refId="demo1"/&gt;
   &lt;refCategoryProfile refId="demo2"/&gt;
   ...
&lt;/context&gt;</pre>Here are defined context
                              <span class="emphasis">with:</span></p>
               
                           
               <p>
                  <div>
                     <ul>
                        <li>
                                             
                           <p><span class="emphasis">id</span> (You can use a specific
                                                context by configuring your portlet with a portlet
                                                preference. This portlet preference must have a name
                                                &#8220;context&#8221; and a value equals to the id you want for this
                                                portlet. If you don't define any context preference for your
                                                portlet then context with id &#8220;default&#8221; is used. With this
                                                mechanism you can define many channels with many contexts
                                                definitions in your portal environment with just one
                                                instance of the portlet.
                           </p>
                           
                                             
                           <p>
                              <div class="note">
                                 <p class="notetitle">
                                    						Note
                                    					
                                 </p>
                                 <p>Before uPortal 2.5.4, because of a bug (<a href="http://www.ja-sig.org/issues/browse/UP-1040">http://www.ja-sig.org/issues/browse/UP-1040</a>)
                                                          you can't use this feature.
                                 </p>
                              </div>
                           </p>
                                           
                        </li>
                        <li>
                                             
                           <p><span class="emphasis">name</span> (displayed on
                                                interface)
                           </p>
                                           
                        </li>
                        <li>
                                             
                           <p><span class="emphasis">description</span> (displayed on
                                                interface)
                           </p>
                                           
                        </li>
                        <li>
                                             
                           <p><span class="emphasis">eferences on category profile</span>
                                                declared in this context (using category profile id)
                           </p>
                                           
                        </li>
                     </ul>
                  </div>You can declare as many category profiles as you
                              want in a context. Each category profile must be defined in an
                              element <span class="emphasis">categoryProfile</span>. A same
                              categoryProfile can be declared in many contexts.
               </p>
                         
            </li>
            <li>
                           
               <p>element <span class="command">categoryProfile</span> :
               </p>
               
                           
               <p><pre class="programlisting">&lt;categoryProfile 
   name="Categorie de d&eacute;mo"
   id="demo1"
   urlCategory="http://partages.univ-rennes1.fr/files/partages/Services/CRI/SI/conf_lecture_gwe_ray/demo1.xml"
   trustCategory="no"
   access="public"
   ttl = "3600" 
   timeout = "3000"&gt; 
   &lt;visibility&gt; ... &lt;/visibility&gt;
&lt;/categoryProfile&gt;</pre>Here are defined category profile
                              <span class="emphasis">id</span>, <span class="emphasis">name</span>, and
               </p>
               
                           
               <p>
                  <div>
                     <ul>
                        <li>
                                             
                           <p><span class="emphasis">urlCategory</span> : url to get back a
                                                xml category file on a remote server -see after for its
                                                description-
                           </p>
                                           
                        </li>
                        <li>
                                             
                           <p><span class="emphasis">trustCategory</span> ( yes | no ) : If
                                                it is <span class="emphasis">"yes"</span>, visibility rights used are
                                                those of remote category and sources. If it is
                                                <span class="emphasis">"no"</span>, visibility rights on category and
                                                sources used are those of this category profile, defined in
                                                <span class="emphasis">visibility</span> element.
                           </p>
                                           
                        </li>
                        <li>
                                             
                           <p><span class="emphasis">access</span> ( public | cas ) : access
                                                of the category is <span class="emphasis">public</span> or
                                                <span class="emphasis">cas</span> because it needs CAS proxy ticket
                                                for authentication -not yet supported -
                           </p>
                                           
                        </li>
                        <li>
                                             
                           <p><span class="emphasis">ttl</span> (seconds) : time to live of
                                                the remote category and its sources
                           </p>
                                           
                        </li>
                        <li>
                                             
                           <p><span class="emphasis">timeout</span> (milliseconds) : time
                                                trying to get the category
                           </p>
                                           
                        </li>
                        <li>
                                             
                           <p><span class="emphasis">visibility</span> : define group
                                                visibility for category referenced by this category profile.
                                                It is used only if <span class="emphasis">trustCategory</span> is set
                                                to "no"
                           </p>
                                           
                        </li>
                     </ul>
                  </div>
               </p>
                         
            </li>
            <li>
                           
               <p>element <span class="command">visibility</span> :
               </p>
               
                           
               <p><pre class="programlisting">&lt;visibility&gt;
   &lt;!-- allowed and autoSubscribed not yet supported --&gt;
   &lt;allowed/&gt;
   &lt;autoSubscribed/&gt;
   &lt;obliged&gt;	
      &lt;group name="local.0"/&gt;
      &lt;group .../&gt; 
      ...
      &lt;regular attribute="sn" value="user" /&gt;
      &lt;regular .../&gt;
      ...
   &lt;/obliged&gt;
&lt;/visibility&gt;</pre>In this element, you define 3 groups of
                              visibility<div>
                     <ul>
                        <li>
                                             
                           <p><span class="emphasis">allowed</span> : user inside are
                                                "allowed" to subscribe to a category - not yet supported
                                                -
                           </p>
                                           
                        </li>
                        <li>
                                             
                           <p><span class="emphasis">autoSubscribed</span> : user inside are
                                                auto subscribed to this category and is allowed to
                                                unsubscribe - not yet supported -
                           </p>
                                           
                        </li>
                        <li>
                                             
                           <p><span class="emphasis">obliged</span> : user inside are
                                                automatically subscribe to this category and can't
                                                unsubscribe - for the moment, it is the only way for users
                                                to see category -
                           </p>
                                           
                        </li>
                     </ul>
                  </div>
               </p>
               
                           
               <p>A user is in a visibility group by two ways :</p>
               
                           
               <p>
                  <div>
                     <ul>
                        <li>
                                             
                           <p><span class="emphasis">group</span> : user is in the portal
                                                group referenced by attribute <span class="emphasis">name</span>, in
                                                the example : user in in group "local.0" - see "portlet.xml"
                                                section.
                           </p>
                                           
                        </li>
                        <li>
                                             
                           <p><span class="emphasis">regular</span> : user check regular, in
                                                the example : user value of portal attribute "sn" is "user"
                                                - see "portlet.xml" section.
                           </p>
                                           
                        </li>
                     </ul>
                  </div>
               </p>
                         
            </li>
            <li>
                           
               <p>element <span class="command">category</span> in xml category file
                              (describe by dtd <span class="command">category.dtd</span>), provided by
                              remote server, requested by <span class="emphasis">urlCategory</span> of
                              esup-lecture.xml :
               </p>
               
                           
               <p><pre class="programlisting">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;!DOCTYPE category SYSTEM "category.dtd"&gt;
&lt;category name="Diff&eacute;rents RSS"&gt;
  &lt;description&gt;Tr&egrave;s belle description !&lt;/description&gt;
  &lt;sourceProfiles&gt;
    &lt;sourceProfile&gt; ... &lt;/sourceProfiles&gt;
    &lt;sourceProfile&gt; ... &lt;/sourceProfiles&gt;
    ...
  &lt;/sourceProfiles&gt;
  &lt;visibility&gt; ... &lt;/visibility&gt;
&lt;/category&gt;</pre>A category has a <span class="emphasis">name</span>
                              and a <span class="emphasis">description</span> (displayed on interface),
                              and
               </p>
               
                           
               <p>
                  <div>
                     <ul>
                        <li>
                                             
                           <p>a list of <span class="emphasis">source profiles</span></p>
                                           
                        </li>
                        <li>
                                             
                           <p><span class="emphasis">visibility</span> : define group
                                                visibility for this category. It is used only if
                                                <span class="emphasis">trustCategory</span> attribute of referencing
                                                <span class="emphasis">categoryProfile</span> is set to "yes" else
                                                visibility of category profile is used - optional -
                           </p>
                                           
                        </li>
                     </ul>
                  </div>
               </p>
                         
            </li>
            <li>
                           
               <p>element <span class="command">sourceProfile</span> in xml category
                              file :
               </p>
               
                           
               <p><pre class="programlisting">&lt;sourceProfile 
  id="un" access="public" name="Incidents techniques Rennes 1" 
  specificUserContent="no" url="http://info.cri.univ-rennes1.fr/rss/rss.php"&gt;
  &lt;visibility&gt; ... &lt;/visibility&gt;

&lt;/sourceProfile&gt;</pre>A source profile has an
                              <span class="emphasis">id</span>, a <span class="emphasis">name</span> (displayed on
                              interface) and 
                  <div>
                     <ul>
                        <li>
                                             
                           <p><span class="emphasis">access</span> ( public | cas ) : access
                                                of the source is <span class="emphasis">public</span> or
                                                <span class="emphasis">cas</span> because it needs CAS proxy ticket
                                                for authentication -not yet supported -
                           </p>
                                           
                        </li>
                        <li>
                                             
                           <p><span class="emphasis">specificUserContent</span> ( yes | no) :
                                                if it is "yes", source content is specific to user. If it is
                                                "no", source content is the same for every users (If your
                                                configure with &#8220;yes&#8221; then application assumes that content
                                                can be deferent for each user (may be because of specific
                                                content due to profiling according to authentication). In
                                                this case application doesn't use any cache for the source.
                                                So be careful before use &#8220;yes&#8221; for this property.)
                           </p>
                                           
                        </li>
                        <li>
                                             
                           <p><span class="emphasis">url</span> : url to get xml stream of
                                                the source
                           </p>
                                           
                        </li>
                        <li>
                                             
                           <p><span class="emphasis">timeout</span> (milliseconds) : Time
                                                trying to get the source. Parent category timeout is used is
                                                it is not defined here
                           </p>
                                           
                        </li>
                        <li>
                                             
                           <p><span class="emphasis">visibility</span> : define group
                                                visibility for source refered by this source profile. It is
                                                used only if <span class="emphasis">trustCategory</span> attribute of
                                                referencing <span class="emphasis">categoryProfile</span> is set to
                                                "yes" else visibility category profile is used - optional
                                                -
                           </p>
                                           
                        </li>
                     </ul>
                  </div>
               </p>
               
                           
               <p>
                  <div class="note">
                     <p class="notetitle">
                        						Note
                        					
                     </p>
                     <p>Be carefull to manage unique id for every sources
                                        profiles defined in categories : application does not yet
                                        manage it.
                     </p>
                  </div>
               </p>
                         
            </li>
         </ul>
      </div>
            
      
            <a name="3.2.2"></a>
              
      <h3>3.2.2.  mappings.xml</h3>
      
              
      <p><span class="command">mappings.xml</span> : it describes a list of
                 mappings used to parse xml stream of a source (see
                 <span class="command">mappings.dtd</span> ):
      </p>
      
              
      <p><pre class="programlisting">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE mappings SYSTEM "mappings.dtd" &gt;
&lt;mappings&gt;
  &lt;mapping&gt; ... &lt;/mapping&gt;
  &lt;mapping&gt; ... &lt;/mapping&gt;
  ...
&lt;/mappings&gt;</pre></p>
      
              
      <p>A source is composed of a list of items that will be parsed to
                 be all displayed on interface . A mapping is used to define
                 <span class="emphasis">xsltFile</span> and <span class="emphasis">itemXPath</span> to
                 apply on a source. Sometimes, to define
                 <span class="emphasis">itemXPath</span>, namespaces definition are required.
                 Here is a mapping :
      </p>
      
              
      <p><pre class="programlisting">&lt;mapping 
  sourceURL="http://info.cri.univ-rennes1.fr/rss/rss.php"
  xsltFile="http://partages.univ-rennes1.fr/files/partages/Services/CRI/SI/conf_lecture_gwe_ray/stylesheet01.xsl"
  itemXPath="/rdf:RDF/default:item"&gt;
  &lt;XPathNameSpace prefix="rdf" uri="http://www.w3.org/1999/02/22-rdf-syntax-ns#"/&gt;
  &lt;XPathNameSpace prefix="default" uri="http://purl.org/rss/1.0/" /&gt;
&lt;/mapping&gt;</pre><div>
            <ul>
               <li>
                                
                  <p><span class="emphasis">xsltFile</span> : url of the xslt file used
                                   to parse an item
                  </p>
                              
               </li>
               <li>
                                
                  <p><span class="emphasis">itemXPath</span> : xpath expression to
                                   locate an item in the xml stream source
                  </p>
                              
               </li>
               <li>
                                
                  <p>element <span class="emphasis">XPathNameSpace</span> : used by
                                   itemXPath definition - optionnal
                  </p>
                              
               </li>
               <li>
                                
                  <p><span class="emphasis">sourceURL</span> : url of the source, key
                                   entry of this mapping
                  </p>
                              
               </li>
               <li>
                                
                  <p><span class="emphasis">dtd</span> : dtd of the source, key entry of
                                   this mapping
                  </p>
                              
               </li>
               <li>
                                
                  <p><span class="emphasis">xmlns</span> : xml namespace of the source,
                                   key entry of this mapping
                  </p>
                              
               </li>
               <li>
                                
                  <p><span class="emphasis">xmlType</span> : xmlType of the source, key
                                   entry of this mapping
                  </p>
                              
               </li>
               <li>
                                
                  <p><span class="emphasis">rootElement</span> : rootElement of the
                                   source,key entry of this mapping
                  </p>
                              
               </li>
            </ul>
         </div>
      </p>
      
              
      <p>Priority to find xslt informations on key entry of a mapping are
                 : sourceURL, DTD, xmlType, xmlns and finally rootElement.
      </p>
            
      
            <a name="3.2.3"></a>
              
      <h3>3.2.3.  portlet.xml</h3>
      
              
      <p>All portal user attributes used by portlet must be declared in
                 the <span class="command">webapp/WEB-INF/portlet.xml</span>, here is an example:
                 <pre class="programlisting">&lt;user-attribute&gt;
  &lt;description&gt;the username of the portal user&lt;/description&gt;
  &lt;name&gt;username&lt;/name&gt;
&lt;/user-attribute&gt;
&lt;user-attribute&gt;
  &lt;description&gt;the displayName of the portal user&lt;/description&gt;
  &lt;name&gt;displayName&lt;/name&gt;
&lt;/user-attribute&gt;
&lt;user-attribute&gt;
  &lt;description&gt;the sn of the portal user&lt;/description&gt;
  &lt;name&gt;sn&lt;/name&gt;
&lt;/user-attribute&gt;</pre></p>
            
      
            <a name="3.2.4"></a>
              
      <h3>3.2.4.  auth.xlm</h3>
      
              
      <p>This file (<span class="command">properties/auth.xml</span>) is used to
                 define auth mecanism. For example when using CAS in servlet mode or a
                 portal in portlet mode:
      </p>
      
              
      <p><pre class="programlisting">&lt;bean id="authenticationService"
  class="org.esupportail.commons.services.authentication.PortalOrCasFilterAuthenticator"&gt;
  &lt;description&gt;The name of the Portal attribute that holds the uid of users, as set in portlet.xml.&lt;/description&gt;
  &lt;property name="uidPortalAttribute" value="uid" /&gt;
&lt;/bean&gt;
</pre></p>
            
          
        <a name="4"></a>
          
      <h1>4.  Servlet mode</h1>
      
          <a name="4.1"></a>
            
      <h2>4.1.  Introduction</h2>
      
            
      <p>You can used esup-lecture in servlet mode. In this mode you don&#8217;t
               have the notion of Portlet preference and you can&#8217;t define more than one
               context in your esup-lecture.xml file. In servlet mode this context must
               have an id with value &#8220;context&#8221;. Example:<pre class="programlisting">&lt;context name="Simple context" <span class="emphasis">id="context"</span>&gt;
  &lt;description&gt;Simple context&lt;/description&gt; 
  &lt;refCategoryProfile refId="rss" /&gt;
&lt;/context&gt;</pre></p>
      
            
      <p>To used serlvet mode you just have to adapt
               <span class="command">buil.properties</span> with
               <span class="command">deploy.type=servlet</span> before using <span class="command">ant
                  deploy</span>.
      </p>
          
      
          <a name="4.2"></a>
            
      <h2>4.2.  Authentication</h2>
      
            
      <p>In servlet mode you can&#8217;t used your portal for authentication. If
               you used CAS you don&#8217;t have to modify the <span class="command">auth.xml</span>
               file but you have to adapt CAS parameters. For this, you will find
               properties (<span class="command">tomcat.host</span>,
               <span class="command">tomcat.port</span>, <span class="command">cas.url</span>) in
               <span class="command">buil.properties</span> file. With these properties
               <span class="command">ant deploy</span> will automatically make appropriate
               changes in your <span class="command">web.xml</span> file.
      </p>
          
      
          <a name="4.3"></a>
            
      <h2>4.3.  Authorization</h2>
      
            
      <p>Authorizations defined in your <span class="command">esup-lecture.xml</span>
               file or provided by news portlet are based in attributes or groups
               issued form uPortal. Of course, in servlet mode you don&#8217;t have access to
               these informations naturally. So, you have to install (if not yet
               present in your uPortal distribution) esup-portal-ws (see <a href="http://sourcesup.cru.fr/projects/esup-portal-ws/">http://sourcesup.cru.fr/projects/esup-portal-ws/</a>).
               After, you have to configure esup-lecture to used this Web Service. For
               this, you have <span class="command">portalService.url</span>,
               <span class="command">portalService.testUserId</span>,
               <span class="command">portalService.testGroupId</span>,
               <span class="command">portalService.testGroupName</span> properties in the
               <span class="command">config.properties</span> file. Finally, you can test the Web
               Service with <span class="command">ant test-portal</span>.
      </p>
          
      
          <a name="4.4"></a>
            
      <h2>4.4.  Guest mode</h2>
      
            
      <p>If want to have a guest mode for esup-lecture in servlet mode you
               have to define a new context in your application server. You have to
               deploy a new esup-lecture in this new context. ???? In this context you
               do not use CAS authentication mechanism ????? 
      </p>
          
        
   </body>
</html>