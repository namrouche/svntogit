<nxthemes:composition xmlns="http://www.w3.org/1999/xhtml"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:t="http://myfaces.apache.org/tomahawk"
  xmlns:nxh="http://nuxeo.org/nxweb/html"
  xmlns:nxthemes="http://nuxeo.org/nxthemes"
  xmlns:a4j="https://ajax4jsf.dev.java.net/ajax"
  xmlns:nxu="http://nuxeo.org/nxweb/util"
  xmlns:nxd="http://nuxeo.org/nxweb/document">

  <ui:define name="page title">
    <h:outputText value="Publication"/>
  </ui:define>

  <ui:define name="body">
    <div>
      <h3><h:outputText value="Publication" /></h3>
      
      <nxu:methodResult value="#{esupPublishActions.getSectionsModel()}" name="documents">
<f:subview
  rendered="#{documents != null and documentVersioning.uidDataAvailable}">

  <h:form >
    <h:outputText value="#{messages['label.sections.not.defined']}"
      rendered="#{documents.rowCount == 0}" />
    <nxu:methodResult value="#{currentDocument.parentRef.toString()}" name="parentRef">
    <nxu:dataTable id="dataTable" value="#{documents.rows}" var="row"
      rowClasses="dataRowEven,dataRowOdd" styleClass="dataOutput"
      rendered="#{documents.rowCount > 0}">
      <nxu:methodResult value="#{row.data.document.ref.toString()}" name="sectionRef">
      <!-- id and selection -->
      <nxu:column styleClass="iconColumn" rendered="true">
        <!-- XXX AT: select all buggy right now -->
        <f:facet name="header">
          <h:selectBooleanCheckbox rendered="false"
            onclilck="selectDataTablePage('#{documents.name}', this.checked)">
          </h:selectBooleanCheckbox>
        </f:facet>
        <h:selectBooleanCheckbox value="#{row.selected}"
            onclick="selectSectionForPublish('#{row.data.document.ref}', this.checked)"
            rendered="#{sectionRef!=parentRef}">
<!-- oncomplete="enableCheckBoxesIn('#{documents.name}:dataTable')"> -->
        </h:selectBooleanCheckbox>
      </nxu:column>
      <!--  Title -->
      <nxu:column>
        <f:facet name="header">
          <h:outputText value="#{messages['label.publish.header.title']}" />
        </f:facet>
        <h:outputText value="#{row.data.treeLabel}" escape="false"/>
      </nxu:column>

    </nxu:methodResult>
    </nxu:dataTable>
    </nxu:methodResult>

<script type="text/javascript">
function confirmDeleteDocuments() {
    return confirm("#{messages['label.documents.confirmDeleteDocuments']}");
}
</script>

  <f:subview rendered="#{!empty publishActions.actionsForPublishDocument}">
    <table class="dataInput" border="0">
      <tr>
        <td class="labelColumn">
          <h:outputText value="#{messages['label.comment']}"/>
        </td>
        <td class="fieldColumn">
          <h:inputTextarea rows="3" cols="30" value="#{publishActions.comment}" id="comment"/>
        </td>
      </tr>
    </table>
  </f:subview>

  <div id="selection_buttons">
    <t:dataList var="sel_action" value="#{publishActions.actionsForPublishDocument}">
      <nxh:commandButton
        styleClass="button" type="submit"
        action="#{sel_action.getLink()}"
        value="#{messages[sel_action.label]}"
        onclick="#{sel_action.confirm}"
        />
    </t:dataList>
  </div>
  <div style="clear:both"></div>


  </h:form>
</f:subview>
</nxu:methodResult>
      
      </div>
  </ui:define>

</nxthemes:composition>

