<project name="esup-ecm-config" default="deploy">

  
  <target name="prepare">
    <mkdir  dir="build"/>
  </target>

  <target name="clean">
    <delete  dir="build"/>

  </target>


  <target name="copy.src.build">
    <copy todir="build" overwrite="yes">
      <fileset dir="datasources"/>
      <fileset dir="esup-ecm-config-plugin"/>
    </copy>


  <target name="replace.token.config" depends="copy.src.build">


    <echo message="Mise a jour des fichiers lies aux base de donnees usuelles (autres que JCR)" />

    <replace file="build/datasources/*.xml"
	     token="@jdbcUser@" value="${db.user}" />
    <replace file="build/datasources/*.xml"
	     token="@jdbcPassword@" value="${db.password}" />
    <replace file="build/datasources/*.xml"
	     token="@jdbcDriver@" value="${db.driver}" />
    <replace file="build/datasources/*.xml"
	     token="@jdbcUrl@" value="${db.url}" />
      

    <echo message="Mise a jour des fichiers lies au plugin de configuration" />

    <!-- CAS -->
    <replace file="build/esup-ecm-config-plugin/src/main/resources/OSGI-INF/login-cas2-contrib.xml" 
	     token="@sso-cas-url@" value="${cas.url}" />

    <!-- LDAP -->

  </target>

  
  <target name="deploy">
    <copy todir="" overwrite="yes">
      <fileset dir="datasources"/>
      <fileset dir="esup-ecm-config-plugin"/>
    </copy>
    <subant target="deploy" buildpath="esup-ecm-config-plugin"/>
  </target>

  </target>

</project>

